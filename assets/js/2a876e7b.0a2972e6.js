"use strict";(self.webpackChunkhousing_repairs_online=self.webpackChunkhousing_repairs_online||[]).push([[4063],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return c}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=s(n),c=r,k=u["".concat(p,".").concat(c)]||u[c]||m[c]||i;return n?a.createElement(k,l(l({ref:t},d),{},{components:n})):a.createElement(k,l({ref:t},d))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=u;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},1352:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return s}});var a=n(3117),r=(n(7294),n(3905));const i={},l="Repairs API",o={unversionedId:"repairs-api/intro",id:"repairs-api/intro",title:"Repairs API",description:"GitHub Repository",source:"@site/docs/repairs-api/intro.md",sourceDirName:"repairs-api",slug:"/repairs-api/intro",permalink:"/housing-repairs-online/repairs-api/intro",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/repairs-api/intro.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Look and feel",permalink:"/housing-repairs-online/front-end/look-and-feel"},next:{title:"Endpoints",permalink:"/housing-repairs-online/category/endpoints"}},p={},s=[{value:"Frameworks used",id:"frameworks-used",level:2},{value:"Blog Storage",id:"blog-storage",level:3},{value:"Cosmos DB",id:"cosmos-db",level:3},{value:"Gov Notify",id:"gov-notify",level:3},{value:"User notifications",id:"user-notifications",level:4},{value:"Internal notification email",id:"internal-notification-email",level:4},{value:"Environment variables",id:"environment-variables",level:2},{value:"Allowed Appointment Slots",id:"allowed-appointment-slots",level:3},{value:"Repair days Mapping",id:"repair-days-mapping",level:3},{value:"Health Checks",id:"health-checks",level:2}],d={toc:s};function m(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"repairs-api"},"Repairs API"),(0,r.kt)("a",{class:"badge badge--secondary",href:"https://github.com/City-of-Lincoln-Council/housing-repairs-online-api"},"GitHub Repository"),(0,r.kt)("h2",{id:"frameworks-used"},"Frameworks used"),(0,r.kt)("p",null,"Written in .Net"),(0,r.kt)("h3",{id:"blog-storage"},"Blog Storage"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-gb/azure/storage/blobs/storage-blobs-introduction"},"Azure Blob storage")," is Microsoft's object storage solution for the cloud.")),(0,r.kt)("p",null,"Photos uploaded as part of the ",(0,r.kt)("a",{parentName:"p",href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("inlineCode",{parentName:"a"},"description.base64img")," in save repair request body")," are uploaded to a container that can be configured via ",(0,r.kt)("a",{parentName:"p",href:"#blob-env"},"environment variables"),"."),(0,r.kt)("h3",{id:"cosmos-db"},"Cosmos DB"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/cosmos-db/introduction"},"Azure Cosmos DB")," is a fully managed NoSQL database service for modern app development.")),(0,r.kt)("p",null,"Submitted repair requests are saved in a container that is configured via ",(0,r.kt)("a",{parentName:"p",href:"#cosmos-env"},"environment variables")," and requests are saved in the following structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "20B2459F",\n    "Postcode": "M3 0W",\n    "SOR": "N373049",\n    "Address": {\n        "Display": "123 Cute Street, LN1 3AT",\n        "LocationId": "53660030    "\n    },\n    "Location": {\n        "Value": "kitchen",\n        "Display": "Kitchen"\n    },\n    "Problem": {\n        "Value": "cupboards",\n        "Display": "Cupboards, including damaged cupboard doors"\n    },\n    "Issue": {\n        "Value": "doorHangingOff",\n        "Display": "Hanging door"\n    },\n    "ContactPersonNumber": "01234567890",\n    "Description": {\n        "PhotoUrl": "https://housingrepairsonline.blob.core.windows.net/housing-repairs-online/eb5adfb6-ed53-4f3b-90c4-7a54cc36c56a.png",\n        "Text": "Excepturi quod aute "\n    },\n    "ContactDetails": {\n        "Type": "email",\n        "Value": "luna@email.com"\n    },\n    "Time": {\n        "Value": "27th January 2022 12:00pm to 4:00pm",\n        "Display": "27th January 2022 between 12:00pm to 4:00pm"\n    },\n    "_rid": "rKg5ANy0vjoVAAAAAAAAAA==",\n    "_self": "dbs/rKg5AA==/colls/rKg5ANy0vjo=/docs/rKg5ANy0vjoVAAAAAAAAAA==/",\n    "_etag": "\\"0f00dbde-0000-1100-0000-61e5367b0000\\"",\n    "_attachments": "attachments/",\n    "_ts": 1642411643\n}\n')),(0,r.kt)("h3",{id:"gov-notify"},"Gov Notify"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://docs.notifications.service.gov.uk/net.html#net-client-documentation"},"GOV.UK Notify")," lets you send emails, text messages and letters to your users.")),(0,r.kt)("p",null,"Once a repair request is saved into Cosmos DB, two notifications are sent - one\nto the user and one to the email that's configured via ",(0,r.kt)("a",{parentName:"p",href:"#email-env"},"environment variables")),(0,r.kt)("h4",{id:"user-notifications"},"User notifications"),(0,r.kt)("p",null,"Email notification template ID is configured via ",(0,r.kt)("a",{parentName:"p",href:"#n-email-env"},"environment variables"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Suggested email template"),(0,r.kt)("div",null,(0,r.kt)("strong",null,"From:")," Lincoln Repairs Online ",(0,r.kt)("br",null),(0,r.kt)("strong",null,"To:")," ((",(0,r.kt)("code",null,"email")," from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"contactDetails.value")),")) ",(0,r.kt)("br",null),(0,r.kt)("strong",null,"Subject:")," Repair details ((",(0,r.kt)("code",null,"repair_ref")," generated when saving into Cosmos DB)) ",(0,r.kt)("br",null),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Your repair has been successfully booked."),(0,r.kt)("p",null,"Your booking details are: ",(0,r.kt)("br",null),"Booking reference: ((",(0,r.kt)("code",null,"repair_ref"),"))",(0,r.kt)("br",null),"Appointment: ((",(0,r.kt)("code",null,"appointment_time")," from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"time.display")),"))"),(0,r.kt)("p",null,"You will receive a reminder the day before your appointment"))),(0,r.kt)("p",null,"SMS notification template ID is configured via ",(0,r.kt)("a",{parentName:"p",href:"#n-sms-env"},"environment variables"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Suggested SMS template"),(0,r.kt)("div",null,(0,r.kt)("strong",null,"To:")," ((phone numer from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"contactDetails.value")),")) ",(0,r.kt)("br",null),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Lincoln Repairs Online: Your repair has been successfully booked. Your booking reference is ((",(0,r.kt)("code",null,"repair_ref"),")) and your selected appointment date is ((",(0,r.kt)("code",null,"appointment_time"),"  from",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"time.display")),"))."))),(0,r.kt)("h4",{id:"internal-notification-email"},"Internal notification email"),(0,r.kt)("p",null,"Email notification template ID is configured via ",(0,r.kt)("a",{parentName:"p",href:"#i-email-env"},"environment variables"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Suggested email template"),(0,r.kt)("div",null,(0,r.kt)("strong",null,"From:")," Lincoln Repairs Online ",(0,r.kt)("br",null),(0,r.kt)("strong",null,"To:")," ((",(0,r.kt)("code",null,"email")," from ",(0,r.kt)("a",{href:"#email-env"},(0,r.kt)("code",null,"INTERNAL_EMAIL")),")) ",(0,r.kt)("br",null),(0,r.kt)("strong",null,"Subject:")," Repair details ((",(0,r.kt)("code",null,"repair_ref")," generated when saving into Cosmos DB)) ",(0,r.kt)("br",null),(0,r.kt)("hr",null),(0,r.kt)("p",null,"A new online repair has been logged. Please add the repair to universal.",(0,r.kt)("br",null),"The repair details are:",(0,r.kt)("br",null),"Repair reference: ((",(0,r.kt)("code",null,"repair_ref"),"))",(0,r.kt)("br",null),"Property Reference: ((",(0,r.kt)("code",null,"uprn")," from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"address.locationId")),"))",(0,r.kt)("br",null),"Address: ((",(0,r.kt)("code",null,"uprn")," from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"address.display")),"))",(0,r.kt)("br",null),"SoR: ((",(0,r.kt)("code",null,"sor")," generated when saving into Cosmos DB ))",(0,r.kt)("br",null),"Description: ((",(0,r.kt)("code",null,"repair_desc")," from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"description.text")),"))",(0,r.kt)("br",null),"Contact number: ((",(0,r.kt)("code",null,"contact_no")," from ",(0,r.kt)("a",{href:"../repairs-api/endpoints/repair#body"},(0,r.kt)("code",null,"contactPersonNumber")),"))",(0,r.kt)("br",null),"Photos uploaded: ((",(0,r.kt)("code",null,"image_1"),"))",(0,r.kt)("br",null)))),(0,r.kt)("h2",{id:"environment-variables"},"Environment variables"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AUTHENTICATION_IDENTIFIER"),(0,r.kt)("td",{parentName:"tr",align:null},"A unique identifier used to validate access")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"JWT_SECRET"),(0,r.kt)("td",{parentName:"tr",align:null},"JWT secret generated")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"../housing-management-system-api/intro"},"ADDRESSES_API_URL")),(0,r.kt)("td",{parentName:"tr",align:null},"Retrieve from App Service once HousingManagementSystemApi is deployed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"../scheduling-api/intro"},"SCHEDULING_API_URL")),(0,r.kt)("td",{parentName:"tr",align:null},"Retrieve from App Service ",(0,r.kt)("em",{parentName:"td"},"Staging")," slot once HousingRepairsSchedulingApi is deployed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{id:"cosmos-env"},"COSMOS_ENDPOINT_URL")),(0,r.kt)("td",{parentName:"tr",align:null},"Cosmos endpoint URL")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"COSMOS_AUTHORIZATION_KEY"),(0,r.kt)("td",{parentName:"tr",align:null},"Cosmos authorization key")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"COSMOS_DATABASE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Cosmos database name, e.g.: ",(0,r.kt)("inlineCode",{parentName:"td"},"housing-repairs-online"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"COSMOS_CONTAINER_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Cosmos table name, e.g.: ",(0,r.kt)("inlineCode",{parentName:"td"},"repairs-requests"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{id:"blob-env"},"AZURE_STORAGE_CONNECTION_STRING")),(0,r.kt)("td",{parentName:"tr",align:null},"Blob storage connection string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"STORAGE_CONTAINER_NAME"),(0,r.kt)("td",{parentName:"tr",align:null},"Storage container name, e.g. ",(0,r.kt)("inlineCode",{parentName:"td"},"housing-repairs-online"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"GOV_NOTIFY_KEY"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notification key")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"TENANT_CONFIRMATION_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify email template ID for tenant repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"TENANT_CONFIRMATION_SMS_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify sms template ID for tenant repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"TENANT_INTERNAL_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify internal email template ID for tenant repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"COMMUNAL_CONFIRMATION_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify email template ID for communal repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"COMMUNAL_CONFIRMATION_SMS_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify sms template ID for communal repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"COMMUNAL_INTERNAL_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify internal email template ID for communal repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LEASEHOLD_CONFIRMATION_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify email template ID for leasehold repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LEASEHOLD_CONFIRMATION_SMS_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify sms template ID for leasehold repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LEASEHOLD_INTERNAL_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify internal email template ID for leasehold repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CANCELLATION_INTERNAL_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify internal email template ID for cancellation of repairs, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"APPOINTMENT_CHANGED_SMS_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify sms template ID for changed appointments, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"APPOINTMENT_CHANGED_EMAIL_NOTIFY_TEMPLATE_ID"),(0,r.kt)("td",{parentName:"tr",align:null},"Gov notify email template ID for changed appointments, this is available once the template is created")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"INTERNAL_EMAIL"),(0,r.kt)("td",{parentName:"tr",align:null},"Internal email address for receiving repair request details, for any manual follow-on process")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"DAYS_UNTIL_IMAGE_EXPIRY"),(0,r.kt)("td",{parentName:"tr",align:null},"Number in days before image uploaded by customer expires, e.g. ",(0,r.kt)("inlineCode",{parentName:"td"},"14")," days")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"../alerting-and-monitoring/intro#azure-component-setup"},"SENTRY_DSN")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://docs.sentry.io/product/sentry-basics/dsn-explainer/"},"Sentry Data Source Name"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOR_CONFIGURATION_TENANT"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"sor-engine/#configuration"},"Schedule of Rates configuration")," that specifies tenant options to offer and their SoR code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOR_CONFIGURATION_COMMUNAL"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"sor-engine/#configuration"},"Schedule of Rates configuration")," that specifies communal options to offer and their SoR code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOR_CONFIGURATION_LEASEHOLD"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"sor-engine/#configuration"},"Schedule of Rates configuration")," that specifies leasehold options to offer and their SoR code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ALLOWED_APPOINTMENT_SLOTS"),(0,r.kt)("td",{parentName:"tr",align:null},"Specifies which appointment slots are allowed (see ",(0,r.kt)("a",{parentName:"td",href:"#allowed-appointment-slots"},"below")," for details)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"REPAIR_PRIORITY_TO_DAYS"),(0,r.kt)("td",{parentName:"tr",align:null},"Specifies the priority to repair days mapping (see ",(0,r.kt)("a",{parentName:"td",href:"#repair-days-mapping"},"below")," for details)")))),(0,r.kt)("p",null,"*"," See ",(0,r.kt)("a",{parentName:"p",href:"../apis/authentication"},"Authentication")," for more details."),(0,r.kt)("h3",{id:"allowed-appointment-slots"},"Allowed Appointment Slots"),(0,r.kt)("p",null,"The value of ",(0,r.kt)("inlineCode",{parentName:"p"},"ALLOWED_APPOINTMENT_SLOTS")," should be in JSON format and be an array of objects with ",(0,r.kt)("inlineCode",{parentName:"p"},"startTime")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"endTime")," defined, i.e."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[\n  {\n    "startTime": "08:00:00",\n    "endTime": "12:00:00"\n  },\n  {\n    "startTime": "12:00:00",\n    "endTime": "18:00:00"\n  },\n  {\n    "startTime": "09:30:00",\n    "endTime": "14:30:00"\n  }\n]\n')),(0,r.kt)("p",null,"Both ",(0,r.kt)("inlineCode",{parentName:"p"},"startTime")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"endTime")," are mandatory.",(0,r.kt)("br",{parentName:"p"}),"\n","The value of ",(0,r.kt)("inlineCode",{parentName:"p"},"ALLOWED_APPOINTMENT_SLOTS")," will be validated on startup.\nIf it is found to be invalid (e.g. malformed JSON or missing ",(0,r.kt)("inlineCode",{parentName:"p"},"startTime")," and/or ",(0,r.kt)("inlineCode",{parentName:"p"},"endTime"),") the API will not start successfully."),(0,r.kt)("p",null,"The following is a JSON schema for the allowed appointment slots data structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "$schema": "https://json-schema.org/draft/2019-09/schema",\n  "definitions": {\n    "appointmentSlotTimeSpan": {\n      "type": "object",\n      "properties": {\n        "startTime": {\n          "type": "string"\n        },\n        "endTime": {\n          "type": "string"\n        }\n      },\n      "required": [\n        "startTime",\n        "endTime"\n      ]\n    }\n  },\n  "type": "array",\n  "items": {\n    "$ref": "#/definitions/appointmentSlotTimeSpan"\n  }\n}\n')),(0,r.kt)("h3",{id:"repair-days-mapping"},"Repair days Mapping"),(0,r.kt)("p",null,"This configuration is for the mapping between a repair's priority and the number of days in which it is expected to be scheduled and completed. This mapping is used when reporting back to the user how long a repair is expected to take."),(0,r.kt)("p",null,"The values of ",(0,r.kt)("inlineCode",{parentName:"p"},"REPAIR_PRIORITY_TO_DAYS_PRODUCTION")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"REPAIR_PRIORITY_TO_DAYS_STAGING")," should be in JSON format and be an array of objects with ",(0,r.kt)("inlineCode",{parentName:"p"},"Priority")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"NumberOfDays")," defined, i.e."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[\n   {\n      "Priority":"2",\n      "NumberOfDays":"30"\n   },\n   {\n      "Priority":"3",\n      "NumberOfDays":"130"\n   }\n]\n')),(0,r.kt)("h2",{id:"health-checks"},"Health Checks"),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"../apis/health-checks"},"Health Checks")," for details."),(0,r.kt)("p",null,"The API is determined to be health if:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Each Housing Repairs API it depends upon is healthy"),(0,r.kt)("li",{parentName:"ul"},"It can connect to the configured Azure Cosmos DB"),(0,r.kt)("li",{parentName:"ul"},"It can connect to the configured Azure Blob storage")))}m.isMDXComponent=!0}}]);